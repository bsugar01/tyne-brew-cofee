on:
  push:
    branches:
      - main

name: ğŸš€ Deploy website on push

jobs:
  web-deploy:
    name: ğŸ‰ Validate and Deploy
    runs-on: ubuntu-latest
    steps:
    - name: ğŸšš Get latest code
      uses: actions/checkout@v4

    - name: ğŸ”§ Set up PHP
      uses: shivammathur/setup-php@v2
      with:
        php-version: '8.2'

    - name: ğŸ–¥ï¸ Start PHP Server in Background
      run: php -S localhost:8000 > /dev/null 2>&1 &

    - name: â˜• Set up Java
      uses: actions/setup-java@v3
      with:
        java-version: '17'
        distribution: 'temurin'

    - name: ğŸ§ª Download vnu.jar (HTML Validator)
      run: |
        mkdir -p tools
        curl -L https://github.com/validator/validator/releases/latest/download/vnu.jar -o tools/vnu.jar

    - name: ğŸ” Validate rendered HTML from PHP
      run: |
        curl http://localhost:8000/index.php -o output.html
        java -jar tools/vnu.jar --Werror output.html


